title = 'Margin Distribution')
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(..count..))) +
geom_histogram(bins = num_bins) +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d() +
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(..count..))) +
geom_histogram(bins = num_bins) +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d()
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins) +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d()
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d()
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(reverse)
?scale_fill_viridis_d()
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d("mako")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d("cividis")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d("G")
marginHist
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d("rocket")
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d("rocket")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(option = "rocket")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(option = "Mako")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(option = "mako")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = 0, option = "mako")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "mako")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "rocket")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margin of Victory (win/loss)", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "rocket")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins of Victory (win/loss)", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "rocket")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins of Victory (win/loss)", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "cividis")
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins of Victory (win/loss)", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = FALSE)
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins of Victory (win/loss)", y = "Frequency",
title = 'Margin Distribution')+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
marginHist
library(viridis)
num_bins <- length(unique(cbbga24$Margin)) / 2
marginHist <- ggplot(cbbga24, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
marginHist
#boxplot of monthly margin distributions
marginMonthly <- ggplot(cbbga24, aes(x = Month, y = Margin, fill = Month)) +
geom_boxplot() +
labs(title = "HOME TEAMS: Monthly Margin of Victory Distribution",
x = "Month",
y = "Margin of Win/Loss") +
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))
marginMonthly
setwd("/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1")
devtools::create('college_basketball.bs')
devtools::create("collegeBasketball.bs")
library(viridis)
marginHist <- function(data, divideBinsBy=2) {
num_bins <- length(unique(cbbga24$Margin)) / divideBins
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=4)
library(viridis)
marginHist <- function(data, divideBinsBy=2) {
num_bins <- length(unique(cbbga24$Margin)) / divideBinsBy
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=4)
plot
library(viridis)
marginHist <- function(data, divideBinsBy=2) {
num_bins <- length(unique(cbbga24$Margin)) / divideBinsBy
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=2)
plot
pwd
getwd()
library(readr)
write_csv(cbbga23, /Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw)
library(readr)
write_csv(cbbga23, Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw)
library(readr)
write_csv(cbbga23, path = Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw)
library(readr)
write_csv(cbbga23, path = bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw)
library(readr)
write_csv(cbbga23, path = 'Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw')
library(readr)
write_csv(cbbga23, file = 'Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw')
setwd("/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw")
getwd()
library(readr)
write_csv(cbbga23, file = '/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw')
library(readr)
write_csv(cbbga23, file = '/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs/data-raw/college_basketball_2023')
setwd("/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs")
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::build_manual()
library{reticulate}
library(reticulate)
install.packages(reticulate)
install.packages('reticulate')
library(reticulate)
install_python('3.12.1')
install_python('3.12.1')
py_install(packages = 'matplotlib')
py_install('numpy')
py_install(packages = 'pandas')
reticulate::repl_python()
cbbga24 <-  read.fwf( "http://kenpom.com/cbbga24.txt",
widths = c(10, 24, 3, 24, 3, 2, 20),
strip.white=TRUE) |>
as_tibble()
library(tidyverse)
library(dplyr)
cbbga24 <- read.fwf( "http://kenpom.com/cbbga24.txt",
widths = c(10, 24, 3, 24, 3, 2, 20),
strip.white=TRUE) |>
as_tibble()
head(cbbga24)
cbbga24 <-  cbbga24 |> rename( 'Date' = V1,
'Team_1' = V2,
'Score_1' = V3,
'Team_2' = V4,
'Score_2' = V5,
'Site_Type' = V6,
'Game_Site' = V7
)
head(cbbga24)
cbbga24 <- cbbga24 |>
mutate(Margin = Score_1-Score_2 )
head(cbbga24)
cbbga24 <- cbbga24 |> arrange(Team_1)
head(cbbga24)
cbbga24 <- cbbga24 |> select(!c(Site_Type, Game_Site))
head(cbbga24)
cbbga24 <-  read.fwf( "http://kenpom.com/cbbga24.txt",
widths = c(10, 24, 3, 24, 3, 2, 20),
strip.white=TRUE) |>
as_tibble() |>
rename( 'Date' = V1,
'Team_1' = V2,
'Score_1' = V3,
'Team_2' = V4,
'Score_2' = V5,
'Site_Type' = V6,
'Game_Site' = V7) |>
mutate(Margin = Score_1-Score_2 ) |>
arrange(Team_1) |>
select(!c(Site_Type, Game_Site))
head(cbbga24)
library(lubridate)
cbbga23 <- cbbga24 |>
mutate(Date = mdy(Date)) |>
#Run only once, a second run will not be able to parse the transformed dates again
filter(between(Date, mdy("01/01/2023"), mdy("12/31/2023")))
head(cbbga23)
byTeamGames <- function(data, team, ungroup){
newTibble <- data |>
rowwise() |>
filter(any(c(Team_1, Team_2) == team)) |>
ungroup() #if there is some other (non-lubridate parsed) formatting
return(newTibble)
}
suu23 = byTeamGames(cbbga23, team = 'Southern Utah', ungroup=TRUE)
suu23
#adding new win/loss columns with strings and dummy-coding
suu23 <- suu23 |>
mutate(Result = case_when(
Team_1 == 'Southern Utah' & Margin > 0 ~ 1,
Team_1 == 'Southern Utah' & Margin < 0 ~ 0,
Team_2 == 'Southern Utah' & Margin < 0 ~ 1,
Team_2 == 'Southern Utah' & Margin > 0 ~ 0)) |>
mutate(WinLoss = case_when(
Result == 1 ~ 'Win',
Result == 0 ~ 'Loss'))
#creating summary tibble
suu23perform <- suu23 |> filter(Team_1 == 'Southern Utah'| Team_2 == 'Southern Utah') |>
summarize(
Wins = sum(WinLoss == 'Win'),
Losses = sum(WinLoss == 'Loss'),
Percent_Win = round(Wins/(Wins+Losses)*100,2) |> paste0("%")
)
suu23perform
team_Record <- function(data, team) {
temp_Tibble <- data |>
mutate(Result = case_when(
Team_1 == team & Margin > 0 ~ 1,
Team_1 == team & Margin < 0 ~ 0,
Team_2 == team & Margin < 0 ~ 1,
Team_2 == team & Margin > 0 ~ 0)) |>
mutate(WinLoss = case_when(
Result == 1 ~ 'Win',
Result == 0 ~ 'Loss'))
#creating summary tibble
result_Tibble <-  temp_Tibble |>
filter(Team_1 == team | Team_2 == team) |>
summarize(
Team = team,
Wins = sum(WinLoss == 'Win'),
Losses = sum(WinLoss == 'Loss'),
Percent_Win = round(Wins/(Wins+Losses)*100,2) %>% paste0("%"))
return(result_Tibble)
}
#Testing function team_Record with Oklahoma State
OKState_Rec = team_Record(cbbga23, 'Oklahoma St.')
OKState_Rec
#seems to work, especially if you don't try Abilene Christian, with the same record as SUU
#and now for a totally different function that does something else to make that all team summary tibble
all_team_Record <- function(data) {
unique_teams <- unique(c(data$Team_1, data$Team_2)) # vector of unique teams
result_Tibble <- tibble() # tibble to store results
for (team in unique_teams) {
new_row <- team_Record(data, team)
result_Tibble <- rbind(result_Tibble, new_row) #add_row() doesn't work here, IDKW
}
return(result_Tibble)
}
#now run nested-function function to obtain result record for all states in 2024
allTeamsResults <- all_team_Record(cbbga24) |>
arrange(desc(Percent_Win))#for 2024
allTeamsResults
library(viridis)
marginHist <- function(data, divideBinsBy=2) {
num_bins <- length(unique(cbbga24$Margin)) / divideBinsBy
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=2)
plot
library(viridis)
marginHist <- function(data, divideBinsBy = 2) {
num_bins <- length(unique(cbbga24$Margin)) / divideBinsBy
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=2)
plot
library(viridis)
marginHist <- function(data) {
num_bins <- length(unique(cbbga24$Margin))
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=2)
library(viridis)
marginHist <- function(data) {
num_bins <- length(unique(cbbga24$Margin))
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24)
plot
library(viridis)
marginHist <- function(data) {
num_bins <- length(unique(cbbga24$Margin))/2
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24)
plot
library(viridis)
marginHist <- function(data) {
num_bins <- length(unique(cbbga24$Margin))
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24)
plot
library(viridis)
marginHist <- function(data, divideBinsBy = 1) {
num_bins <- length(unique(cbbga24$Margin)) / divideBinsBy
marginHist <- ggplot(data, aes(x = Margin, fill = factor(after_stat(count)))) +
geom_histogram(bins = num_bins, color = 'grey25') +
labs(x = "Margins", y = "Frequency",
title = 'Distribution of Victory Margins (win/loss)')+
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))+
scale_fill_viridis_d(direction = -1, option = "cividis")+
guides(fill = 'none')
}
plot <- marginHist(cbbga24, divideBinsBy=1)
plot
cbbga24Month <- cbbga24 |>
mutate(Date = mdy(Date)) |>
mutate(Month = month(Date)) |>   #only run once, thank you...
mutate(Month = factor(Month, levels = c(11, 12, 1, 2)))
cbbga24Month
#boxplot of monthly margin distributions
marginMonthly <- ggplot(cbbga24Month, aes(x = Month, y = Margin, fill = Month)) +
geom_boxplot() +
labs(title = "HOME TEAMS: Monthly Margin of Victory Distribution",
x = "Month",
y = "Margin of Win/Loss") +
theme(axis.title=element_text(size = 14),
plot.title =element_text(size = 14, face = "bold"))
marginMonthly
reticulate::repl_python()
library(tidyverse)
library(dplyr)
data24 <- read.fwf( "http://kenpom.com/cbbga24.txt",
widths = c(10, 24, 3, 24, 3, 2, 20),
strip.white=TRUE) |>
as_tibble()
head(cbbga24)
reticulate::repl_python()
setwd("/Users/bram/Documents/Math_3190/Math_3190_Assignments/Homework/Homework_1/collegeBasketball.bs")
devtool::document()
devtools::document()
devtools::build()
devtools::install()
?marginHist()
